import nmap
import json

# Initialize the scanner
nm = nmap.PortScanner()

# Define the target IP range or hostnames
target = '192.168.124.132'  # Adjust this to your network range

# Scan the network for devices and try to identify the OS
nm.scan(hosts=target, arguments='-O')

# Iterate through all the found devices
for host in nm.all_hosts():
    print(f'Host : {host} ({nm[host].hostname()})')
    print(f'State : {nm[host].state()}')

    #print(json.dumps(nm[host]))

    #print(nm[host]["osmatch"])
    
    
    # Check if OS detection was successful
    if 'osclass' in nm[host]["osmatch"][0]:
        for osclass in nm[host]['osmatch'][0]['osclass']:
            print(f'OS Type : {osclass["type"]}')
            print(f'OS Vendor : {osclass["vendor"]}')
            print(f'OS Family : {osclass["osfamily"]}')
            print(f'OS Generation : {osclass["osgen"]}')
            print('------------------------------------')
    else:
        print('No OS detection available')
    print('')

# Note: Running this script might require administrative/sudo privileges.