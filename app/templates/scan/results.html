<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Comprehensive Security Vulnerability Report</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
            padding-bottom: 20px; /* Adjust the value as needed */

        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="/">Automated Penetration Tester</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav ml-auto">
                    {% if user.is_authenticated %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            {{ user.username }}
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
                            <a class="dropdown-item" href="/profile">View Profile</a>
                            <a class="dropdown-item" href="/auth/logout">Sign Out</a>
                        </div>
                    </li>
                    {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="/auth/login">Sign In</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/auth/register">Register</a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-5">
        <h1 class="text-center mb-4">Comprehensive Security Vulnerability Report</h1>
        <h2 class="text-center mb-4">{{  results.target  }}</h1>

        {% if results.success == false %}
        <div class="alert alert-danger" role="alert">
            <h4 class="alert-heading">Failed Test</h4>
            <p>The scan has failed, which could be due to the target not existing or unreachable at the moment.</p>
        </div>
        {% else %}
        <div class="card mb-3">
            <div class="card-body">
                <h2 class="card-title">SQL Injection Vulnerability Assessment</h2>
                <p>This section of the report focuses on SQL Injection vulnerabilities, which can allow attackers to manipulate database queries and potentially access or modify sensitive data unauthorizedly. Identifying and mitigating these vulnerabilities is crucial for the security of your web applications.</p>
                <h4>Findings</h4>
                <p>- Total URLs Tested: {{ results.sql_injection.total }}</p>
                <p>- Vulnerable URLs Identified: {{ results.sql_injection.vulnerable }}</p>
                <p>- URLs with No Vulnerabilities Detected: {{ results.sql_injection.non_vulnerable }}</p>
                <p>- Errors During Testing: {{ results.sql_injection.errors }}</p>
                {% if results.sql_injection.vulnerable_urls %}
                <h4>Details on Vulnerable URLs:</h4>
                <ul>
                    {% for url in results.sql_injection.vulnerable_urls %}
                    <li>{{ url }}</li>
                    {% endfor %}
                </ul>
                <h4>Recommendations</h4>
                <ul>
                    <li><strong>Parameterized Queries:</strong> Use parameterized queries to prevent SQL injection.</li>
                    <li><strong>Input Validation:</strong> Validate user inputs to ensure they conform to expected
                        formats.</li>
                    <li><strong>ORM Tools:</strong> Utilize ORM tools that abstract SQL queries and help prevent
                        injection.</li>
                    <li><strong>Regular Security Audits:</strong> Conduct regular security audits and penetration
                        testing.</li>
                    <li><a target="_blank" href="/scan/results/sql/{{ scan_id }}">Click here for more info</a></li>
                </ul>
                {% else %}
                <p>No vulnerable URLs were found during the SQL Injection tests. Continuous monitoring and regular testing
                    are recommended to maintain security.</p>
                {% endif %}
            </div>
        </div>

<!-- LFI Section -->
<div class="card mb-3">
    <div class="card-body">
        <h2 class="card-title">Local File Inclusion (LFI) Vulnerability Assessment</h2>
        <p>Local File Inclusion vulnerabilities could allow attackers to read sensitive files on your server, leading to information disclosure or other attacks.</p>
        <h4>Findings</h4>
        <p>Total URLs Tested: {{ results.lfi.total }}</p>
        <p>Vulnerable URLs Identified: {{ results.lfi.vulnerable }}</p>
        <p>URLs with No Vulnerabilities Detected: {{ results.lfi.non_vulnerable }}</p>
        <p>Errors During Testing: {{ results.lfi.errors }}</p>
        {% if results.lfi.vulnerable_urls %}
        <h4>Details on Vulnerable URLs:</h4>
        <ul>
            {% for url in results.lfi.vulnerable_urls %}
            <li>{{ url }}</li>
            {% endfor %}
        </ul>
        <h4>Recommendations</h4>
        <ul>
            <li><strong>Server Configuration:</strong> Configure the server to limit file access and execution to only
                those directories and files that are necessary for your application to function.</li>
            <li><strong>Input Sanitization:</strong> Thoroughly sanitize user inputs to ensure that file paths or
                commands are not manipulable by end users.</li>
            <li><strong>Use of Whitelists:</strong> Implement whitelisting for file access, allowing only approved files
                to be included or executed.</li>
            <li><a href="/scan/results/lfi/{{ scan_id }}" target="_blank">Click here for more info</a></li>
        </ul>
        {% else %}
        <p>No vulnerable URLs were found during the LFI tests. Continuous monitoring and regular testing are recommended
            to maintain security</p>
        {% endif %}
    </div>
</div>

<!-- CSRF Section -->
<div class="card mb-3">
    <div class="card-body">
        <h2 class="card-title">Cross-Site Request Forgery (CSRF) Vulnerability Assessment</h2>
        <p>CSRF vulnerabilities can trick users into executing actions on a web application where they are currently authenticated, leading to unauthorized actions being performed.</p>
        <h4>Findings</h4>
        <p>Total URLs Tested: {{ results.csrf.total }}</p>
        <p>Vulnerable URLs Identified: {{ results.csrf.vulnerable }}</p>
        <p>URLs with No Vulnerabilities Detected: {{ results.csrf.non_vulnerable }}</p>
        <p>Errors During Testing: {{ results.csrf.errors }}</p>
        {% if results.csrf.vulnerable_urls %}
        <h4>Details on Vulnerable URLs:</h4>
        <ul>
            {% for url in results.csrf.vulnerable_urls %}
            <li>{{ url }}</li>
            {% endfor %}
        </ul>
        <h4>Recommendations</h4>
        <ul>
            <li><strong>Use Anti-CSRF Tokens:</strong> Implement anti-CSRF tokens in forms and requests that perform
                state-changing operations.</li>
            <li><strong>SameSite Cookie Attribute:</strong> Use the SameSite cookie attribute to prevent the browser
                from sending this cookie along with cross-site requests.</li>
            <li><strong>Reauthentication for Sensitive Actions:</strong> Require reauthentication for performing
                sensitive actions within the application.</li>
            <li><a href="/scan/results/csrf/{{ scan_id }}" target="_blank">Click here for more info</a></li>

        </ul>
        {% else %}
        <p>No vulnerable URLs were found during the CSRF tests. Continuous monitoring and regular testing are
            recommended to maintain security.</p>
        {% endif %}
    </div>
</div>

<!-- IDOR Section -->
<div class="card mb-3">
    <div class="card-body">
        <h2 class="card-title">Insecure Direct Object References (IDOR) Vulnerability Assessment</h2>
        <p>IDOR vulnerabilities can allow unauthorized access to sensitive data or functionality by exploiting predictable resource locations or direct object references.</p>
        <h4>Findings</h4>
        <p>Total URLs Tested: {{ results.idor.total }}</p>
        <p>Vulnerable URLs Identified: {{ results.idor.vulnerable }}</p>
        <p>URLs with No Vulnerabilities Detected: {{ results.idor.non_vulnerable }}</p>
        <p>Errors During Testing: {{ results.idor.errors }}</p>
        {% if results.idor.vulnerable_urls %}
        <h4>Details on Vulnerable URLs:</h4>
        <ul>
            {% for url in results.idor.vulnerable_urls %}
            <li>{{ url }}</li>
            {% endfor %}
        </ul>
        <p><strong>Note:</strong> The identification of vulnerabilities may include false positives due to the automated
            nature of the tests. Manual verification is recommended to confirm any findings, especially for IDOR
            vulnerabilities, where nuanced access control logic may not be fully assessed</p>
        <h4>Recommendations</h4>
        <ul>
            <li><strong>Access Control:</strong> Implement robust access control checks to ensure that users can only
                access objects they are authorized to.</li>
            <li><strong>Indirect Object References:</strong> Use indirect object references or other indirect methods to
                access objects, rather than exposing direct references.</li>
            <li><a href="/scan/results/idor/{{ scan_id }}" target="_blank">Click here for more info</a></li>

        </ul>
        {% else %}
        <p>No vulnerable URLs were found during the IDOR tests. Continuous monitoring and regular testing are
            recommended to maintain security.</p>
        {% endif %}
    </div>
</div>

<!-- TestSSL Section -->
<div class="card mb-3">
    <div class="card-body">
        <h2 class="card-title">SSL/TLS Configuration and Vulnerability Assessment</h2>
        <p>Testing the SSL/TLS configurations ensures that the encryption standards protect against eavesdropping and man-in-the-middle attacks.</p>
        <h4>Findings</h4>
        {% if results.testssl.is_bad_protocols or results.testssl.is_bad_vulns %}
            {% if results.testssl.is_bad_protocols %}
            <h5>Weak or Insecure Protocols Detected:</h5>
            <ul>
                {% for protocol, status in results.testssl.bad_protocols.items() %}
                <li><strong>{{ protocol }}:</strong> {{ status }}</li>
                {% endfor %}
            </ul>
            {% endif %}
            {% if results.testssl.is_bad_vulns %}
            <h5>Vulnerabilities Detected:</h5>
            <ul>
                {% for vuln, status in results.testssl.bad_vulns.items() %}
                <li><strong>{{ vuln }}:</strong> {{ status }}</li>
                {% endfor %}
            </ul>
            {% endif %}
            <div class="recommendations">
                <h4>Recommendations</h4>
                <ul>
                    <li><strong>Protocol Upgrades:</strong> Disable insecure or deprecated protocols and enable secure ones, such as TLS 1.2 or TLS 1.3, to enhance security.</li>
                    <li><strong>Vulnerability Mitigation:</strong> Address identified vulnerabilities by applying patches, updating configurations, and following best practices for SSL/TLS security.</li>
                    <li><strong>Regular Security Assessments:</strong> Conduct regular SSL/TLS security assessments to identify and mitigate newly discovered vulnerabilities and configuration issues.</li>
                </ul>
            </div>
        {% else %}
        <p>No significant vulnerabilities or weak protocols were detected during the SSL/TLS security testing. Continuing to monitor and regularly re-evaluate your SSL/TLS configurations is recommended to maintain strong security postures.</p>
        {% endif %}
    </div>
</div>
{% endif %} 
        <div class="text-center mt-4">
            <a href="/" class="btn btn-primary">Return Home</a>
            <br>
        </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>

</html>
