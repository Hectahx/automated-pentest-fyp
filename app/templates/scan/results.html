<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Comprehensive Security Vulnerability Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        h1,
        h2,
        h3 {
            color: #333;
        }

        .section {
            margin-bottom: 20px;
        }

        ul {
            list-style-type: none;
        }

        li {
            margin-bottom: 10px;
        }

        /* Button styles */
        .home-button {
            display: inline-block;
            background-color: #4CAF50;
            /* Green background */
            color: white;
            /* White text */
            padding: 10px 20px;
            /* Some padding */
            text-align: center;
            /* Center the text */
            text-decoration: none;
            /* Remove underline from links */
            font-size: 16px;
            /* Increase font size */
            margin: 4px 2px;
            /* Some margin */
            cursor: pointer;
            /* Pointer/hand icon */
            border-radius: 5px;
            /* Rounded corners */
        }

        .home-button:hover {
            background-color: #45a049;
            /* Darker shade of green */
        }
    </style>
</head>

<body>
    <h1>Comprehensive Security Vulnerability Report</h1>

    <!-- SQL Injection Section -->
    <div class="section" id="sql-injection">
        <h2>SQL Injection Vulnerability Assessment</h2>
        <div class="overview">
            <h3>Overview</h3>
            <p>This section of the report focuses on SQL Injection vulnerabilities, which can allow attackers to
                manipulate database queries and potentially access or modify sensitive data unauthorizedly. Identifying
                and mitigating these vulnerabilities is crucial for the security of your web applications.</p>
        </div>
        <div class="findings">
            <h3>Findings</h3>
            <p>- Total URLs Tested: {{ results.sql_injection.total }}</p>
            <p>- Vulnerable URLs Identified: {{ results.sql_injection.vulnerable }}</p>
            <p>- URLs with No Vulnerabilities Detected: {{ results.sql_injection.non_vulnerable }}</p>
            <p>- Errors During Testing: {{ results.sql_injection.errors }}</p>
            {% if results.sql_injection.vulnerable_urls %}
            <h4>Details on Vulnerable URLs:</h4>
            <ul>
                {% for url in results.sql_injection.vulnerable_urls %}
                <li>{{ url }}</li>
                {% endfor %}
            </ul>
            <div class="recommendations">
                <h3>Recommendations</h3>
                <ul>
                    <li><strong>Parameterized Queries:</strong> Use parameterized queries to prevent SQL injection.</li>
                    <li><strong>Input Validation:</strong> Validate user inputs to ensure they conform to expected
                        formats.</li>
                    <li><strong>ORM Tools:</strong> Utilize ORM tools that abstract SQL queries and help prevent
                        injection.</li>
                    <li><strong>Regular Security Audits:</strong> Conduct regular security audits and penetration
                        testing.</li>
                    <li><a href="/scan/results/sql/{{ scan_id }}">Click here for more info</a></li>
                </ul>
            </div>
            {% else %}
            <p>No vulnerable URLs were found during the SQL Injection tests. Continuous monitoring and regular testing
                are recommended to maintain security.</p>
            {% endif %}
        </div>
    </div>

    <!-- Placeholders for Other Tests -->
    <!-- LFI Section -->
    <div class="section" id="lfi">
        <h2>Local File Inclusion (LFI) Assessment</h2>
        <p>Local File Inclusion vulnerabilities allow attackers to read or execute files on the server that hosts the
            web application. This could potentially lead to sensitive information disclosure or server compromise.</p>

        <h3>Findings</h3>
        <p>- Total URLs Tested: {{ results.lfi.total }}</p>
        <p>- Vulnerable URLs Identified: {{ results.lfi.vulnerable }}</p>
        <p>- URLs with No Vulnerabilities Detected: {{ results.lfi.non_vulnerable }}</p>
        <p>- Errors During Testing: {{ results.lfi.errors }}</p>

        {% if results.lfi.vulnerable_urls %}
        <h4>Details on Vulnerable URLs:</h4>
        <ul>
            {% for url in results.lfi.vulnerable_urls %}
            <li>{{ url }}</li>
            {% endfor %}
        </ul>
        <h3>Recommendations</h3>
        <ul>
            <li><strong>Server Configuration:</strong> Configure the server to limit file access and execution to only
                those directories and files that are necessary for your application to function.</li>
            <li><strong>Input Sanitization:</strong> Thoroughly sanitize user inputs to ensure that file paths or
                commands are not manipulable by end users.</li>
            <li><strong>Use of Whitelists:</strong> Implement whitelisting for file access, allowing only approved files
                to be included or executed.</li>
            <li><a href="/scan/results/lfi/{{ scan_id }}">Click here for more info</a></li>
        </ul>
        {% else %}
        <p>No vulnerable URLs were found during the LFI tests. Continuous monitoring and regular testing are recommended
            to maintain security.</p>
        {% endif %}
    </div>

    <!-- CSRF Section -->
    <div class="section" id="csrf">
        <h2>Cross-Site Request Forgery (CSRF) Assessment</h2>
        <p>CSRF vulnerabilities can trick a user into executing unwanted actions on a web application in which they're
            authenticated. Protecting against CSRF attacks is crucial for maintaining the integrity of user
            interactions.</p>

        <h3>Findings</h3>
        <p>- Total URLs Tested: {{ results.csrf.total }}</p>
        <p>- Vulnerable URLs Identified: {{ results.csrf.vulnerable }}</p>
        <p>- URLs with No Vulnerabilities Detected: {{ results.csrf.non_vulnerable }}</p>
        <p>- Errors During Testing: {{ results.csrf.errors }}</p>

        {% if results.csrf.vulnerable_urls %}
        <h4>Details on Vulnerable URLs:</h4>
        <ul>
            {% for url in results.csrf.vulnerable_urls %}
            <li>{{ url }}</li>
            {% endfor %}
        </ul>
        <h3>Recommendations</h3>
        <ul>
            <li><strong>Use Anti-CSRF Tokens:</strong> Implement anti-CSRF tokens in forms and requests that perform
                state-changing operations.</li>
            <li><strong>SameSite Cookie Attribute:</strong> Use the SameSite cookie attribute to prevent the browser
                from sending this cookie along with cross-site requests.</li>
            <li><strong>Reauthentication for Sensitive Actions:</strong> Require reauthentication for performing
                sensitive actions within the application.</li>
            <li><a href="/scan/results/csrf/{{ scan_id }}">Click here for more info</a></li>

        </ul>
        {% else %}
        <p>No vulnerable URLs were found during the CSRF tests. Continuous monitoring and regular testing are
            recommended to maintain security.</p>
        {% endif %}
    </div>

    <!-- IDOR Section -->
    <div class="section" id="idor">
        <h2>Insecure Direct Object References (IDOR) Assessment</h2>
        <p>IDOR vulnerabilities occur when an application provides direct access to objects based on user-supplied
            input. This can lead to unauthorized access to sensitive information.</p>

        <h3>Findings</h3>
        <p>- Total URLs Tested: {{ results.idor.total }}</p>
        <p>- Vulnerable URLs Identified: {{ results.idor.vulnerable }}</p>
        <p>- URLs with No Vulnerabilities Detected: {{ results.idor.non_vulnerable }}</p>
        <p>- Errors During Testing: {{ results.idor.errors }}</p>

        {% if results.idor.vulnerable_urls %}
        <h4>Details on Vulnerable URLs:</h4>
        <ul>
            {% for url in results.idor.vulnerable_urls %}
            <li>{{ url }}</li>
            {% endfor %}
        </ul>
        <p><strong>Note:</strong> The identification of vulnerabilities may include false positives due to the automated
            nature of the tests. Manual verification is recommended to confirm any findings, especially for IDOR
            vulnerabilities, where nuanced access control logic may not be fully assessed</p>
        <h3>Recommendations</h3>
        <ul>
            <li><strong>Access Control:</strong> Implement robust access control checks to ensure that users can only
                access objects they are authorized to.</li>
            <li><strong>Indirect Object References:</strong> Use indirect object references or other indirect methods to
                access objects, rather than exposing direct references.</li>
            <li><a href="/scan/results/idor/{{ scan_id }}">Click here for more info</a></li>

        </ul>
        {% else %}
        <p>No vulnerable URLs were found during the IDOR tests. Continuous monitoring and regular testing are
            recommended to maintain security.</p>
        {% endif %}
    </div>

    <!-- TestSSL Section -->
    <div class="section" id="testssl">
        <h2>SSL/TLS Security Testing (TestSSL)</h2>
        <p>SSL/TLS security testing evaluates the encryption protocols and configurations used by your web application to ensure secure data transmission and protect against eavesdropping and man-in-the-middle attacks.</p>

        <h3>Findings</h3>
        {% if results.testssl.is_bad_protocols or results.testssl.is_bad_vulns %}
            {% if results.testssl.is_bad_protocols %}
            <h4>Weak or Insecure Protocols Detected:</h4>
            <ul>
                {% for protocol, status in results.testssl.bad_protocols.items() %}
                <li><strong>{{ protocol }}:</strong> {{ status }}</li>
                {% endfor %}
            </ul>
            {% endif %}
            {% if results.testssl.is_bad_vulns %}
            <h4>Vulnerabilities Detected:</h4>
            <ul>
                {% for vuln, status in results.testssl.bad_vulns.items() %}
                <li><strong>{{ vuln }}:</strong> {{ status }}</li>
                {% endfor %}
            </ul>
            {% endif %}
            <div class="recommendations">
                <h3>Recommendations</h3>
                <ul>
                    <li><strong>Protocol Upgrades:</strong> Disable insecure or deprecated protocols and enable secure ones, such as TLS 1.2 or TLS 1.3, to enhance security.</li>
                    <li><strong>Vulnerability Mitigation:</strong> Address identified vulnerabilities by applying patches, updating configurations, and following best practices for SSL/TLS security.</li>
                    <li><strong>Regular Security Assessments:</strong> Conduct regular SSL/TLS security assessments to identify and mitigate newly discovered vulnerabilities and configuration issues.</li>
                </ul>
            </div>
        {% else %}
        <p>No significant vulnerabilities or weak protocols were detected during the SSL/TLS security testing. Continuing to monitor and regularly re-evaluate your SSL/TLS configurations is recommended to maintain strong security postures.</p>
        {% endif %}
    </div>

    <div class="conclusion">
        <h2>Conclusion</h2>
        <p>Ensuring the security of your web applications involves vigilance and regular testing across multiple
            vectors, including but not limited to SQL Injection, LFI, CSRF, IDOR, and SSL/TLS configurations. Addressing
            vulnerabilities in these areas is paramount to safeguarding your data and protecting your users.</p>
    </div>

    <!-- Return Home Button -->
    <div class="return-home">
        <a href="/" class="home-button">Return Home</a>
    </div>
</body>

</html>